# Поиск математических утверждений в базе данных.

Цель проекта написание программы, которая осуществляла бы такой поиск в некоторой базе данных. Предполагается, что как заданная теорема, так и теоремы из базы данных записаны на естественном языке (возможно, с использованием математических формул, представленных в формате системы tex). При этом в программе должно учитываться, что формулировки заданной теоремы и той же теоремы в базе данных могут несколько отличаться. В любом случае, формулировка этой теоремы из базы данных должна появиться среди лучших кандидатов, найденных программой.

## Установка необходимых программ
1. Установить Python 3
2. Запустить install.bat
3. Для визуализации деревьев используется пакет GraphViz. https://graphviz.gitlab.io/download/ 
   Папку bin необходимо положить в корневую директорию проекта.
4. На данном этапе встроенный синтаксический анализатор. https://stanfordnlp.github.io/stanfordnlp/ 
   Для его работы нужно вручную скачать модель Syntagrus, 
   Она доступна здесь https://stanfordnlp.github.io/stanfordnlp/models.html 
   Все файлы из архива (их должно быть 5) положить в директорию ru_syntagrus_models (должна находится в корневой директории)

-- Как запустить ?
1. Запустить bat-файл start.bat

-- Описание интерфейса:
   Интерфейс представляет собой 4 текстовых поля и ряд кнопок
   
## Текстовые поля 
Поле ввода (верхнее) используется для ввода информации.
Поле вывода данных (1) (левое центральное) используется для вывода результата работы.
Поле вывода данных (2) (правое центральное) используется для вывода информации.
Поле вывода ошибок (нижнее) используется для вывода ошибок, возникших в результате работы

## Кнопки 

Clean - очистка всех текстовых полей кроме поля ввода

Load_and_run - обращается к файлу конфигурации, ищет поле Infile. К указанному там путю к файлу будет добавлен путь корневой директории
			 Данные из данного файла (текстовое утверждение или массив с синтаксической информацией) будет преобразован в формулу данного утверждения.
			 Результат разбора будет выведен Поле вывода данных (1)
			 Входные данные для разбора будут выведены в Поле вывода данных (2)
			 
Parse - данные из поля ввода (текстовое утверждение или массив с синтаксической информацией) будут преобразованы в формулу данного утверждения.	 
		Результат разбора будет выведен в Поле вывода данных (1)	 
		Примечание. Можно подавать только одно утверждение за раз !

Rank - запуск ранжирования. 
	   Данные из поля ввода (текстовое утверждение или массив с синтаксической информацией) будут преобразованы 
	   в формулу данного утверждения. Данная формула будет сравниваться с каждой формулой из базы формул. 
	   Чем выше результат сравнения (от 0 до 1), тем выше формула из базы формул будет в итоговой выдаче.
	   Отсортированные формулы из базы формул будут выведены в Поле вывода данных (1)
	   В начале выводится разбор данных из Поля ввода.
	   Результаты сравнения будут выведены в Поле вывода данных (2)
	   
	   Примечание. Смена алгоритма ранжирования посредством графического интерфейса пока не поддерживается.

Test - запуск тестирующего модуля.
	   -- Принцип работы 
	   В директории Database находится директории Теоремы (в этой директории теоремы в разных формулировках)
		  В текстовом файле file_list.txt указано из каких файлов следует выбрать теоремы.
		  Каждой теореме присваивается свой номер. Формулировки одних и тех же теорем объединяются в некоторые множества.
		  Для каждой теоремы строится своя формула и эта формула заносится в базу данных.
		  
	   Имеется база данных формул в количестве 8 элементов. $A_i$ (i=1..8). Для каждого $i$  известны индексы той же самой теоремы, но в другой формулировке. Предположим, что для теоремы с номером $i$ теоремой с другой формулировкой будет теорема  с индексом $j \,(j \neq i, \, j=1..8)$. Для данной теоремы множество номеров равно $\{i,j\}$. Выберем произвольный номер $k \,\, (k=1..8)$. Для теоремы $A_k$ из изначальной базы данных проведем все этапы работы программы. Сравним разбор теоремы $A_k$ с каждой имеющейся в базе данных формул $A_i$. Получим таблицу ранжирования с индексами формул $p_1,p_2,....,p_8$. Итоговый результат будем хранить в переменной $mark$.\\

	$mark=0$. Для  $\forall m \,\,(m=1..8)$:\\

	Если $p_m\neq i \,\, \&\& \,\, p_m \neq j$, то $mark=mark-1$\\

	Если $p_m == i$, то множество номеров будет равно $\{j\}$ \\	

	Если $p_m == j$, то множество номеров будет равно $\{i\}$ \\

	Если множество номеров пусто, то завершаем тестирование.
	   Результат тестирования будут выведены в Поле вывода данных (2)
	   Представление входных данных в виде формул, искомый индекс и множество номеров будут выведены в Поле вывода данных (1)
	   
Picture - модуль отрисовки формул.   
	  Отрисовывает Данные из поля ввода в отдельном окне.
	  Примечание. Входные данные должны быть в формате списка вложенных списков.

Edit_config - редактирование файла конфигурации. Данные из данного файла будут выведены в Поле вывода данных (2)
	Для сохранения изменений изменений необходимо нажать кнопку Save_config
	
Help - вывод вспомогательной информации.
		  
## Краткое описание основных папок и файлов, используемых в программе 

### Директории:

Database: содержит базу данных для ранжирования и файлы для ее формирования
Files: содержит
		   -- директорию dicts, содержащую набор словарей
		   -- файл-конфигурации (параметры для работы программы)
		   -- файл с грамматикой TatSu, 
		   -- файлы с разборами математических формул.

ru_syntagrus_models: Для работы синтаксического анализатора нужно вручную скачать модель Syntagrus. Она доступна здесь https://stanfordnlp.github.io/stanfordnlp/models.html .Все файлы из архива (их должно быть 5) находятся в данной директории

Test: набор файлов для проверки тестирования программы.

Tree: хранение картинок с визуализацией
    
### Scripts: набор скриптов на языке Python 3.
		draw_graph.py -- скрипт, осуществляющий визуализацию
		
		filler.py -- вспомогательный скрипт
		
		formula_simplifier.py -- скрипт, осуществляющий упрощение формулы на языке TeX
		
		formula_tree.py -- преобразование упрощенной формулы в древовидную форму.
		
		gui.py -- основной скрипт графического интерфейса, осуществляющий взаимодействие со всеми остальными скриптами.
		
		gui_function.py -- модуль, обеспечивающий взаимодействие графического интерфейса с другими модулями.
		
		ranger.py -- скрипт-ранжировщик.
		
		ranger_algo.py -- хранят части от разных ранжировщиков.
		
		stamford.py -- скрипт, преобразующий входный текст при помощи Stamford в синтаксическое дерево в формате список списков.
		text_predicator.py -- скрипт, преобразующий синтаксическое дерево в формате список списков в формулу логики предикатов.
		
		text_tree.py -- скрипт, преобразующий входные данные в синтаксическое дерево в формате список списков или формулу логики предикатов.
		
		testing_block.py -- скрипт, осуществляющий тестирование отдельных модулей.
		
		utilities.py -- вспомогательные функции, используемые в других скриптах.

    
### Известные баги

1. Дерево предикатов строится на данном этапе с ошибками.

2. Алгоритм ранжирования находится на раннем этапе разработки.

3. Не проведена унификация формул.

