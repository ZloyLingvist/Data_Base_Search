# Поиск математических утверждений в базе данных.

Программа, которая осуществляла бы такой поиск в некоторой базе данных.Предполагается, что как заданная теорема, так и теоремы 
из базы данных записаны на естественном языке (возможно, с использованием математических формул, представленных в формате системы tex). При этом в программе должно
учитываться, что формулировки заданной теоремы и той же теоремы в базе данных могут несколько отличаться. 
В любом случае, формулировка этой теоремы из базы данных должна появиться среди лучших кандидатов, найденных программой.

## Начало работы

Запустить gui_main.py. В появившемся окне в выпадающем списке выбрать формат данных, с которыми предстоит работать. 
На данном этапе доступны:
1. Использование уже разобранных предложения в conllu-формате (для их создания использовался синтаксический анализатор Abbyy Compreno -- Теорема в формате Abbyy)
2. Преобразование непосредственно введенной теоремы в поле Теорема (используется встроенный синтаксический анализатор Stamford nlp Parser -- Теорема в формате Stamford)
3. Подача в программу непосредственно разобранного дерева (список списков -- Разобранное дерево)
4. Для того, чтобы работать с формулой в формате tex в меню выбрать пункт Режимы - Работа с формулами.

#### Описание интерфейса

###### Кнопки
1. Ранжирование разборов. Автоматически разбирает введенную теорему (либо из файла, либо из поля для ввода)
2. Сделать разбор. Представление теоремы из файла или введенной теоремы в виде формулы.
3. Очистка. Очищает основное текстовое поле программы
4. Показать дерево. Строит по формуле дерево и выводит его на экран.
5. Установка библиотек.
6. Редактировать config-файл. Имена, пути всех необходимых для работы программы файлов занесены в файл конфигурации. После изменения нужно нажаь кнопку Сохранить

###### Меню
1. Параметры разбора.
1.1. Показать дерево при помощи ОС.
1.2. Синтаксическое дерево/Формула логики предикатов (0/1). В зависимости от включенного параметра формула останется в виде списка списков синтаксического представления или дополнительно будет преобразована к виду формулы логики предикатов.
2. Режимы
2.1 Работа с формулами. При нажатии будет открыто новое окно для работы непосредственно с формулами на языке tex
2.2 Режим разработчика. Открытие нового окна, в котором можно создавать базы данных для программы.
3. Выход - завершение работы программы

### Установка необходимых компонентов
Недостающие компоненты можно установить нажатием кнопки Установка библиотек.
В программе используются следующие компоненты.
1. Для преобразования формул на языке TeX библиотека TatSu. https://github.com/neogeny/TatSu Документация https://tatsu.readthedocs.io/en/stable/intro.html
2. Для визуализации деревьев используется пакет GraphViz. https://graphviz.gitlab.io/download/ Папку bin необходимо положить в корневую папку проекта.
3. Встроенный синтаксический анализатор. https://stanfordnlp.github.io/stanfordnlp/ Для работы используется модель Syntagrus, доступная здесь https://stanfordnlp.github.io/stanfordnlp/models.html
####### Команды для установки
1. Установка tatsu: pip install tatsu
2. Установка torch: pip install --no-cache-dir torch==1.2.0+cpu torchvision==0.4.0+cpu -f https://download.pytorch.org/whl/torch_stable.html")
3. Установка stanfordnlp: pip install stanfordnlp

### Краткое описание основных папок и файлов, используемых в программе.

###### Папки

1. dicts: Набор словарей
2. Files: файл-конфигурации, файл с грамматикой TatSu, скрипт, позволяющий использовать всплывающие подсказки.
3. ru_syntagrus_models: скачать архив с моделью Syntagrus и положить в данную директорию
4. Temp: хранение баз данных 
5. Text: хранение текстовых данных
6. Trees: хранение картинок с визуализацией

###### Скрипты
1. combine_formula_text.py -- объединение разбора текстовой части и разбора формулы
2. draw_graph.py -- скрипт, осуществляющий визуализацию
3. formula_simplifier.py -- скрипт, осуществляющий упрощение формулы на языке TeX
4. formula_tree.py -- преобразование упрощенной формулы в древовидную форму.
5. gui_formula.py -- графический интерфейс для работы с формулами.
6. gui_main.py -- основной скрипт графического интерфейса, осуществляющий взаимодействие со всеми остальными скриптами.
7. gui_utilit.py -- интерфейс, для создания баз данных
8. ranger.py -- скрипт-ранжировщик.
9. stamford.py -- скрипт, преобразующий входный текст при помощи Stamford в синтаксическое дерево в формате список списков.
10. text_predicator.py -- скрипт, преобразующий синтаксическое дерево в формате список списков в формулу логики предикатов.
11. text_tree.py -- скрипт, преобразующий входные данные в синтаксическое дерево в формате список списков или формулу логики предикатов.
12. utilities.py -- вспомогательные функции, используемые в других скриптах.



